# Using i18n-generator with Vite

i18n-generator works perfectly with Vite through the CLI tool. No plugin needed!

## Installation

```bash
npm install i18n-generator --save-dev
# or
pnpm add -D i18n-generator
```

## Configuration

Create `i18n.config.js` in your project root:

```javascript
module.exports = {
	languages: ['vi', 'en', 'zh', 'ja'],
	inputDir: './src/translations',
	outputDir: './public/locales',
};
```

## package.json Scripts

```json
{
	"scripts": {
		"dev": "i18n-gen && vite",
		"build": "i18n-gen && vite build",
		"preview": "vite preview",
		"i18n": "i18n-gen"
	}
}
```

## Project Structure

```
my-vite-app/
├── src/
│   ├── translations/          # Input translations
│   │   ├── common.json
│   │   ├── auth.json
│   │   └── booking.json
│   ├── i18n.ts               # i18next setup
│   ├── App.tsx
│   └── main.tsx
├── public/
│   └── locales/              # Generated by i18n-gen
│       ├── vi/
│       ├── en/
│       └── ...
├── i18n.config.js            # i18n-generator config
├── vite.config.ts
└── package.json
```

## i18next Setup (TypeScript)

### src/i18n.ts

```typescript
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import HttpBackend from 'i18next-http-backend';

i18n
	.use(HttpBackend)
	.use(initReactI18next)
	.init({
		lng: 'vi',
		fallbackLng: 'en',
		ns: ['common', 'auth', 'booking'],
		defaultNS: 'common',

		backend: {
			loadPath: '/locales/{{lng}}/{{ns}}.json',
		},

		interpolation: {
			escapeValue: false,
		},
	});

export default i18n;
```

### src/main.tsx

```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './i18n'; // Initialize i18next

ReactDOM.createRoot(document.getElementById('root')!).render(
	<React.StrictMode>
		<App />
	</React.StrictMode>
);
```

### src/App.tsx

```typescript
import { useTranslation } from 'react-i18next';

function App() {
	const { t, i18n } = useTranslation(['common', 'auth']);

	const changeLanguage = (lng: string) => {
		i18n.changeLanguage(lng);
	};

	return (
		<div>
			<h1>{t('common:welcome')}</h1>
			<p>{t('common:hello')}</p>

			<div>
				<button onClick={() => changeLanguage('vi')}>Tiếng Việt</button>
				<button onClick={() => changeLanguage('en')}>English</button>
			</div>

			{/* Nested object example */}
			<h2>{t('auth:login.title')}</h2>
			<input placeholder={t('auth:login.email.placeholder')} />
		</div>
	);
}

export default App;
```

## vite.config.ts

No plugin configuration needed! Just use the CLI.

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
	plugins: [react()],
});
```

## Development Workflow

```bash
# Generate translations before starting dev server
pnpm run dev

# Or run separately
pnpm i18n          # Generate translations
pnpm vite          # Start dev server
```

## Production Build

```bash
# Generate and build
pnpm run build

# Preview production build
pnpm preview
```

## Watch Mode (Coming Soon)

```bash
# Auto-regenerate on file changes
pnpm i18n-gen --watch
```

## Alternative: Pre-build Hook

If you want to ensure translations are always generated:

### package.json

```json
{
	"scripts": {
		"prebuild": "i18n-gen",
		"build": "vite build",
		"predev": "i18n-gen",
		"dev": "vite"
	}
}
```

Now `i18n-gen` runs automatically before `dev` and `build`.

## TypeScript Support

Install dependencies:

```bash
pnpm add i18next react-i18next i18next-http-backend
pnpm add -D @types/i18next
```

### Type-safe translations

```typescript
// src/types/i18n.d.ts
import 'react-i18next';

interface CommonTranslations {
	welcome: string;
	hello: string;
}

interface AuthTranslations {
	login: {
		title: string;
		email: {
			placeholder: string;
		};
	};
}

declare module 'react-i18next' {
	interface CustomTypeOptions {
		defaultNS: 'common';
		resources: {
			common: CommonTranslations;
			auth: AuthTranslations;
		};
	}
}
```

Now you get autocomplete:

```typescript
t('common:welcome');        // ✅ Type-safe
t('auth:login.title');      // ✅ Type-safe
t('invalid:key');           // ❌ TypeScript error
```

## Environment Variables

You can use env variables in your config:

```javascript
// i18n.config.js
module.exports = {
	languages: process.env.VITE_LANGUAGES?.split(',') || ['vi', 'en'],
	inputDir: './src/translations',
	outputDir: './public/locales',
};
```

```bash
# .env
VITE_LANGUAGES=vi,en,zh,ja,ko
```

## Best Practices

1. **Run i18n-gen before dev/build** - Ensure translations are always up to date
2. **Commit generated files** - Or generate during CI/CD
3. **Use HTTP backend** - Better for Vite's dev server
4. **Type your translations** - Get autocomplete and type safety
5. **Organize by feature** - Keep related translations together

## Comparison: Webpack vs Vite

| Feature | Webpack Plugin | Vite CLI |
|---------|----------------|----------|
| Setup | Plugin in config | Script in package.json |
| Auto-run | On webpack build | Manual or pre-hook |
| Speed | Webpack build time | Instant CLI |
| Watch mode | Built-in | Coming soon |
| HMR | Yes | Via pre-hook |

## Need Help?

- [Main README](./README.md)
- [TypeScript Guide](./TYPESCRIPT.md)
- [GitHub Issues](https://github.com/yourusername/i18n-generator/issues)
